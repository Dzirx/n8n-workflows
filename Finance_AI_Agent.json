{
  "name": "Finance AI Agent",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "daysInterval": 2,
              "triggerAtHour": 8
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -880,
        360
      ],
      "id": "ae939be6-63e0-4fd3-bd88-874ca615b864",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "YOUR_GOOGLE_SHEETS_DOCUMENT_ID",
          "mode": "list",
          "cachedResultName": "Portfel_xtb",
          "cachedResultUrl": ""
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Arkusz1",
          "cachedResultUrl": ""
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -660,
        360
      ],
      "id": "64d9a4d2-d607-4ab9-8bd7-25e07e3515ef",
      "name": "Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_GOOGLE_SHEETS_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "Symbol"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -440,
        360
      ],
      "id": "55bccb8b-3f47-45a9-9a64-e4d287a4f61a",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.perplexity.ai/chat/completions",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer YOUR_PERPLEXITY_API_KEY"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"temperature\": 0.2,\n  \"top_p\": 0.9,\n  \"return_images\": false,\n  \"return_related_questions\": false,\n  \"top_k\": 0,\n  \"stream\": false,\n  \"presence_penalty\": 0,\n  \"frequency_penalty\": 1,\n  \"web_search_options\": {\n    \"search_context_size\": \"low\"\n  },\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"Jeste≈õ specjalistycznym asystentem inwestycyjnym. Twoim zadaniem jest przeszukiwanie internetu w poszukiwaniu najnowszych i najwa≈ºniejszych informacji dotyczƒÖcych sp√≥≈Çek i ETF-√≥w z portfela inwestycyjnego u≈ºytkownika. Odpowied≈∫ przygotuj W JƒòZYKU POLSKIM. Skup siƒô wy≈ÇƒÖcznie na wiadomo≈õciach z ostatnich 24 godzin. U≈ºytkownik przekazuje Ci listƒô symboli gie≈Çdowych, kt√≥re posiada w swoim portfelu. ZADANIE: 1. Przeszukaj internet w poszukiwaniu najnowszych informacji (z ostatnich 24 godzin) dotyczƒÖcych KA≈ªDEJ z wymienionych sp√≥≈Çek/ETF-√≥w: - Wa≈ºne og≈Çoszenia firmowe (wyniki finansowe, fuzje, przejƒôcia) - Rekomendacje analityk√≥w i zmiany cen docelowych - Istotne zmiany w wolumenie obrotu - Informacje bran≈ºowe mogƒÖce wp≈ÇynƒÖƒá na notowania - Dla ETF-√≥w: zmiany w sk≈Çadzie, przep≈Çywach kapita≈Çu, strukturze 2. Dla ka≈ºdej znalezionej informacji podaj: - Symbol sp√≥≈Çki/ETF-a - Kr√≥tkie, rzeczowe streszczenie informacji (1-2 zdania) - Potencjalny wp≈Çyw na warto≈õƒá inwestycji (je≈õli mo≈ºliwy do okre≈õlenia) - ≈πr√≥d≈Ço informacji (opcjonalnie) 3. Je≈õli dla danej sp√≥≈Çki/ETF-a nie znaleziono ≈ºadnych istotnych informacji z ostatnich 24 godzin, umie≈õƒá jƒÖ w sekcji Sp√≥≈Çki bez istotnych informacji. FORMAT WYJ≈öCIA: - Nag≈Ç√≥wek z dzisiejszƒÖ datƒÖ - Sekcja NAJWA≈ªNIEJSZE WYDARZENIA z 3-5 najistotniejszymi informacjami z dnia - Informacje pogrupowane w 3 kategorie z odpowiednimi emoji: * üî¥ WYDARZENIA O NEGATYWNYM WP≈ÅYWIE * üü¢ WYDARZENIA O POZYTYWNYM WP≈ÅYWIE * üü° WYDARZENIA O NEUTRALNYM/MIESZANYM WP≈ÅYWIE * ‚ö™ SP√ì≈ÅKI BEZ ISTOTNYCH INFORMACJI Z OSTATNICH 24H (lista sp√≥≈Çek) - Sekcja REKOMENDOWANE OBSERWACJE z listƒÖ 2-3 sp√≥≈Çek lub sektor√≥w wartych szczeg√≥lnej uwagi - Kr√≥tkie podsumowanie og√≥lnej sytuacji rynkowej na podstawie znalezionych informacji\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"{{ $json.Symbol }}\"\n    }\n  ],\n  \"model\": \"sonar-deep-research\\t\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -240,
        360
      ],
      "id": "aa30815a-26ca-4528-9551-52c1e6580042",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "GPT-4O-MINI"
        },
        "messages": {
          "values": [
            {
              "content": "=Przekszta≈Çƒá poni≈ºszy tekst raportowy na format HTML dla Telegram Bot API:\n\n1. Sformatuj jako czytelny raport z w≈Ça≈õciwƒÖ hierarchiƒÖ (zamie≈Ñ ## na <b> dla nag≈Ç√≥wk√≥w sekcji)\n2. Zamie≈Ñ ### na <b> dla nazw sp√≥≈Çek\n3. Pogrubij wszystkie wystƒôpujƒÖce **fragmenty** u≈ºywajƒÖc <b>\n4. Usu≈Ñ tabelƒô z sekcji \"Sp√≥≈Çki Bez Istotnych Informacji\" i zastƒÖp jƒÖ prostƒÖ listƒÖ z pogrubionymi symbolami\n5. Dodaj emoji do nag≈Ç√≥wk√≥w sekcji (üî¥ dla Negatywnego, üü¢ dla Pozytywnego, üü° dla Neutralnego, ‚ö™ dla Bez Informacji)\n6. Usu≈Ñ stopkƒô \"*This message was sent automatically with *n8n19:27\"\n7. Usu≈Ñ znaczniki &nbsp;\n8. Zachowaj strukturƒô z pustymi liniami miƒôdzy sekcjami dla czytelno≈õci\n9. U≈ºywaj tylko tag√≥w HTML obs≈Çugiwanych przez Telegram (<b>, <i>, <u>, <s>, <code>, <pre>, <a>)\n10. Usu≈Ñ odniesienia do ≈∫r√≥de≈Ç w nawiasach kwadratowych [8][11][15][16][17][19][20]\n11. Usu≈Ñ hiper≈ÇƒÖcza a href\n12. Nie tworz ul ani li usu≈Ñ dodatkowo wszytskie te ~ znaczniki\n\n\nZwr√≥ƒá kompletny kod HTML gotowy do u≈ºycia w Telegram Bot API.\n{{ $json.choices[0].message.content }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -40,
        360
      ],
      "id": "586a4bd9-68b1-42a4-bbd8-afe75ed4da0c",
      "name": "OpenAI1",
      "credentials": {
        "openAiApi": {
          "id": "YOUR_OPENAI_CREDENTIAL_ID",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "YOUR_TELEGRAM_CHAT_ID",
        "text": "={{ $json.message.content.html || $json.message.content.text }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        320,
        360
      ],
      "id": "b18c634b-b651-47d1-9146-ea36da4674e1",
      "name": "Telegram",
      "webhookId": "YOUR_WEBHOOK_ID",
      "alwaysOutputData": false,
      "executeOnce": false,
      "retryOnFail": false,
      "notesInFlow": false,
      "credentials": {
        "telegramApi": {
          "id": "YOUR_TELEGRAM_CREDENTIAL_ID",
          "name": "Finance telegram bot"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "OpenAI1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI1": {
      "main": [
        [
          {
            "node": "Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "WORKFLOW_VERSION_ID",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "YOUR_N8N_INSTANCE_ID"
  },
  "id": "YOUR_WORKFLOW_ID",
  "tags": []
}